{% extends "base.html" %}
{% block content %}

<div class="text-center" style="margin-bottom: 60px;">
  <h1 class="display-title">Indicator <span class="gradient-text">Armory</span></h1>
  <p class="lead-text">Install once. Calibrate daily. Execute forever.</p>
</div>

<div class="bento-grid">

  <div class="bento-card">
    <div style="display:flex; justify-content:space-between; margin-bottom:16px;">
      <h3 style="color:var(--success);">KTBB Execution Levels</h3>
      <span style="font-size:24px;">âš¡</span>
    </div>
    <p style="margin-bottom:24px; color:var(--text-muted); font-size:14px;">
      The core engine. Draws your Daily Support, Resistance, Triggers, and the 30m Anchor Box based on Spot Data.
    </p>
    <button class="btn secondary" style="width:100%" onclick="copyIndicator('/static/indicators/ktbb_trade_levels.pine', this)">
      Copy Source Code
    </button>
  </div>

  <div class="bento-card">
    <div style="display:flex; justify-content:space-between; margin-bottom:16px;">
      <h3 style="color:var(--primary-bright);">HTF Supply & Demand</h3>
      <span style="font-size:24px;">ðŸ“Š</span>
    </div>
    <p style="margin-bottom:24px; color:var(--text-muted); font-size:14px;">
      Automatically maps 4H and 1H supply/demand zones. Provides higher-timeframe context for your intraday execution.
    </p>
    <button class="btn secondary" style="width:100%" onclick="copyIndicator('/static/indicators/kttb_htf_supply_and_demand.pine', this)">
      Copy Source Code
    </button>
  </div>

</div>

<div class="bento-card wide" style="margin-bottom: 60px;">
  <div style="border-bottom: 1px solid var(--glass-border); padding-bottom: 24px; margin-bottom: 32px;">
    <h3>Installation Protocol</h3>
    <p class="lead-text" style="font-size: 16px; margin: 8px 0 0 0; max-width: 100%;">
      Follow this sequence to sync your TradingView chart with the Kabroda Engine.
    </p>
  </div>

  <div class="bento-grid" style="gap: 16px; margin-bottom: 0; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
    
    <div style="background: rgba(255,255,255,0.03); padding: 24px; border-radius: 12px; border: 1px solid var(--glass-border);">
      <div style="color: var(--primary-bright); font-weight: 900; font-size: 12px; letter-spacing: 0.1em; margin-bottom: 12px;">STEP 01</div>
      <h4 style="color: #fff; margin-bottom: 8px;">Open Editor</h4>
      <p style="font-size: 13px; color: var(--text-muted); line-height: 1.5;">
        At the bottom of your TradingView chart, click the tab labeled <strong>Pine Editor</strong>.
      </p>
    </div>

    <div style="background: rgba(255,255,255,0.03); padding: 24px; border-radius: 12px; border: 1px solid var(--glass-border);">
      <div style="color: var(--primary-bright); font-weight: 900; font-size: 12px; letter-spacing: 0.1em; margin-bottom: 12px;">STEP 02</div>
      <h4 style="color: #fff; margin-bottom: 8px;">Create New</h4>
      <p style="font-size: 13px; color: var(--text-muted); line-height: 1.5;">
        Click <strong>Open</strong> (top right of editor) â†’ <strong>New blank indicator</strong>. Delete all default text.
      </p>
    </div>

    <div style="background: rgba(255,255,255,0.03); padding: 24px; border-radius: 12px; border: 1px solid var(--glass-border);">
      <div style="color: var(--primary-bright); font-weight: 900; font-size: 12px; letter-spacing: 0.1em; margin-bottom: 12px;">STEP 03</div>
      <h4 style="color: #fff; margin-bottom: 8px;">Paste & Deploy</h4>
      <p style="font-size: 13px; color: var(--text-muted); line-height: 1.5;">
        Paste the Kabroda code. Click <strong>Add to Chart</strong>. Save the script as "KTBB Levels".
      </p>
    </div>

  </div>
  
</div>
<div class="bento-card wide" style="margin-top: 40px; border-top: 1px solid var(--glass-border);">
  <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 20px;">
    <div>
      <h3 style="margin-bottom: 8px;">Visual Intelligence</h3>
      <p style="color: var(--text-muted); font-size: 14px; margin: 0;">
        Need a briefing? Watch the Installation Protocol and Daily Calibration guides.
      </p>
    </div>
    <div>
      <a href="https://www.youtube.com/@Kabroda" target="_blank" class="btn secondary">
        <span style="margin-right: 8px;">ðŸ“º</span> ACCESS VIDEO ARCHIVE
      </a>
    </div>
  </div>
</div>

<script>
async function copyIndicator(url, btn){
  const original = btn.innerText;
  btn.innerText = "Extracting Code...";
  btn.disabled = true;
  try {
    const r = await fetch(url);
    if(!r.ok) throw new Error("Fetch failed");
    const t = await r.text();
    await navigator.clipboard.writeText(t);
    btn.innerText = "Copied to Clipboard";
    // Reset button after 2 seconds
    setTimeout(() => { 
      btn.innerText = original; 
      btn.disabled = false;
    }, 2000);
  } catch(e) { 
    console.error(e);
    alert("Error fetching indicator code. Please try again."); 
    btn.innerText = original;
    btn.disabled = false;
  }
}
</script>
{% endblock %}